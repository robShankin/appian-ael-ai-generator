# Data Update Process

This guide explains how to update the Appian function data when a new version of Appian is released.

## Overview

The extension relies on data from two sources:
1. **Function Reference Data** - Generated by [Appian Documentation Scraper](https://github.com/robShankin/appian-docs-scraper)
2. **Best Practices** - Manually curated from Appian documentation

## Prerequisites

- Access to the [Appian Documentation Scraper](https://github.com/robShankin/appian-docs-scraper) repository
- Python 3.x installed
- Local clone of this repository
- `vsce` package tool installed

## Part 1: Update Function Data

### Step 1: Set Up the Scraper

```bash
# Clone or navigate to the scraper project
cd /Users/robert.shankin/kiro_projects/docScraper

# Or clone if you don't have it:
# git clone https://github.com/robShankin/appian-docs-scraper.git
# cd appian-docs-scraper

# Install dependencies
pip install -r requirements.txt
```

### Step 2: Update Scraper for New Appian Version

Edit the scraper scripts to target the new Appian version:

**In `scrape_appian_docs.py`:**
```python
# Change the base_url to the new version
def __init__(self, base_url: str = "https://docs.appian.com/suite/help/XX.X/Appian_Functions.html"):
    # Replace XX.X with new version (e.g., 25.4 â†’ 26.1)
```

**In `scrape_appian_docs_enhanced.py`:**
```python
# Update the same base_url
def __init__(self, base_url: str = "https://docs.appian.com/suite/help/XX.X/Appian_Functions.html"):
```

### Step 3: Run the Scrapers

```bash
# Run the basic scraper (generates appian-functions-complete.json)
python3 scrape_appian_docs.py

# Run the enhanced scraper (generates appian-functions-docs.json)
python3 scrape_appian_docs_enhanced.py
```

**Expected Output:**
- `appian-functions-complete.json` (~290KB) - VS Code snippet format
- `appian-functions-docs.json` (~1MB) - Enriched documentation

**Time:** ~25-30 minutes for full scrape

### Step 4: Verify the Output

Check the generated files:

```bash
# Count functions
cat appian-functions-complete.json | grep '"Appian ' | wc -l
# Should show ~713 or more

# Check for errors
grep -i "error\|failed" appian-functions-complete.json
grep -i "error\|failed" appian-functions-docs.json
```

### Step 5: Copy Files to Extension Project

```bash
# From the docScraper directory, copy to CodeCompletion
cp appian-functions-complete.json /Users/robert.shankin/codingRepo/CodeCompletion/unpacked-extension/extension/
cp appian-functions-docs.json /Users/robert.shankin/codingRepo/CodeCompletion/unpacked-extension/extension/
```

**Note:** The `appian-functions-reference.json` is derived from `appian-functions-complete.json` and may need to be regenerated using conversion scripts.

### Step 6: Test the Updated Data

```bash
# Navigate to extension directory
cd /Users/robert.shankin/codingRepo/CodeCompletion/unpacked-extension/extension

# Rebuild the extension
vsce package --no-dependencies
```

**Manual Testing:**
1. Install the new `.vsix` file in VS Code/Cursor
2. Test a few code generation requests:
   - Try a common function (e.g., "create a forEach loop")
   - Try a new function (if any were added in the new version)
   - Check that autocomplete works correctly
   - Verify function examples appear in generated code

### Step 7: Update Version Numbers

If the data update warrants a new extension version:

**Update `package.json`:**
```json
{
  "version": "1.X.X"  // Increment appropriately
}
```

**Update documentation:**
- `README.md` - Update Appian version reference
- `VERSION_X.X.X_SUMMARY.md` - Create new summary if needed
- `QUICK_START.md` - Update references to `.vsix` filename

## Part 2: Update Best Practices (If Needed)

Best practices are manually curated. When a new Appian version introduces new patterns or changes:

### Step 1: Review New Documentation

Visit the Appian documentation pages for the new version:
- Parts of an Expression
- Local Variables
- Null Handling
- Best Practices
- Performance Guidelines
- Advanced Evaluation

### Step 2: Identify New Practices

Look for:
- New syntax rules or limitations
- New performance guidelines
- New functions for common patterns
- Deprecated practices
- Changed behavior

### Step 3: Update `appian-best-practices.json`

Edit the file to add/modify practices:

```json
{
  "rule": "Clear statement of the new practice",
  "example": "Code example demonstrating it",
  "priority": "critical|high|medium",
  "keywords": ["relevant", "keywords", "for", "filtering"]
}
```

**Categories:**
- `coreRules` - Fundamental AEL syntax
- `performance` - Optimization guidelines
- `nullHandling` - Null/empty value patterns
- `localVariables` - Variable scoping
- `advanced` - Complex patterns

### Step 4: Test the Best Practices

1. Try generating code that should trigger the new practice
2. Verify the practice appears in the generated prompt
3. Check that the AI uses the practice in generated code

## Part 3: Commit and Release

### Step 1: Commit Changes

```bash
cd /Users/robert.shankin/codingRepo/CodeCompletion

git add .
git commit -m "Update to Appian XX.X function data

- Updated function reference data (XXX functions)
- Updated best practices for new version
- Rebuilt extension package

Data sourced from appian-docs-scraper vX.X.X"

git push origin main
```

### Step 2: Create Release (Optional)

If this is a significant update:

1. Tag the release:
   ```bash
   git tag -a vX.X.X -m "Appian XX.X compatibility"
   git push origin vX.X.X
   ```

2. Create GitHub release with:
   - Release notes
   - Attached `.vsix` file
   - Changelog of what's new

### Step 3: Update Scraper Repository

Don't forget to commit the scraper changes:

```bash
cd /Users/robert.shankin/kiro_projects/docScraper

git add .
git commit -m "Update for Appian XX.X documentation"
git push origin main
```

## Troubleshooting

### Scraper Fails
- **Check URL**: Verify the Appian docs URL is correct for the new version
- **Check HTML structure**: Appian may have changed their page structure
- **Update selectors**: Modify BeautifulSoup selectors in the scraper

### Function Count Mismatch
- **Check logs**: Look for extraction errors in scraper output
- **Verify manually**: Spot-check a few functions on the Appian docs site
- **Check filters**: Ensure scraper isn't excluding valid functions

### Extension Fails to Build
- **Check JSON validity**: Use `jsonlint` or similar on generated files
- **Check file paths**: Ensure files are in correct directories
- **Check package.json**: Verify version and paths are correct

### Generated Code Is Wrong
- **Check function signatures**: Verify scraped parameters match Appian docs
- **Check examples**: Ensure examples are correctly extracted
- **Update best practices**: New syntax rules may need to be added

## Quick Reference

### File Locations

**Scraper Project:**
- `/Users/robert.shankin/kiro_projects/docScraper/`
- Output: `appian-functions-complete.json`, `appian-functions-docs.json`

**Extension Project:**
- `/Users/robert.shankin/codingRepo/CodeCompletion/unpacked-extension/extension/`
- Data files: `appian-functions-complete.json`, `appian-functions-docs.json`, `appian-best-practices.json`

### Key Commands

```bash
# Run scraper
python3 scrape_appian_docs.py
python3 scrape_appian_docs_enhanced.py

# Copy files
cp *.json /path/to/CodeCompletion/unpacked-extension/extension/

# Build extension
cd /path/to/CodeCompletion/unpacked-extension/extension
vsce package --no-dependencies

# Test
# Install .vsix and try code generation
```

## Version Correspondence

| Extension Version | Appian Version | Date Updated |
|-------------------|----------------|--------------|
| 1.4.1             | 25.4           | Dec 2024     |

## Questions?

- **Scraper Issues**: [appian-docs-scraper Issues](https://github.com/robShankin/appian-docs-scraper/issues)
- **Extension Issues**: [appian-ael-ai-generator Issues](https://github.com/robShankin/appian-ael-ai-generator/issues)
- **General Questions**: [Discussions](https://github.com/robShankin/appian-ael-ai-generator/discussions)

---

**Last Updated:** December 2024
**Current Appian Version:** 25.4
**Current Extension Version:** 1.4.1
